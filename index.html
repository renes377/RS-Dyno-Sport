<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SlotCar Cockpit V5.1</title>
    <link rel="manifest" href="manifest.json">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111827; color: white; }
        
        /* Navigation States */
        .main-tab-button.active { background-color: #1F2937; color: white; border-bottom: 3px solid #3B82F6; }
        .main-tab-button.inactive { background-color: #374151; color: #9CA3AF; }
        
        .tab-button.active { background-color: #3B82F6; color: white; }
        .tab-button.inactive { background-color: #374151; color: #9CA3AF; }

        /* Content Visibility - WICHTIG damit nicht alles untereinander steht */
        .main-content-area { display: none; }
        .main-content-area.active { display: block; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Modals */
        .modal { display: none; position: fixed; z-index: 50; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.85); align-items: center; justify-content: center; backdrop-filter: blur(2px); }
        .modal-content { margin: 5vh auto; padding: 24px; width: 90%; max-width: 500px; position: relative; }
        .modal-content-large { max-width: 800px; }

        /* Tabellen */
        .logbook-table-wrapper { width: 100%; overflow-x: auto; margin-top: 10px; border-radius: 8px; border: 1px solid #374151; }
        .logbook-table { width: 100%; min-width: 800px; border-collapse: collapse; }
        .logbook-table th, .logbook-table td { border: 1px solid #4B5563; padding: 8px 12px; text-align: left; font-size: 0.85rem; white-space: nowrap; }
        .logbook-table th { background-color: #1F2937; font-weight: 700; cursor: pointer; }
        .logbook-table tbody tr:nth-child(odd) { background-color: #111827; }
        .logbook-table tbody tr:nth-child(even) { background-color: #1F2937; }
        .logbook-table tbody tr:hover { background-color: #374151; }

        /* Scrollbars */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        
        .hidden-file-input { display: none; }
    </style>
</head>
<body class="flex items-start justify-center p-2 md:p-4 min-h-screen">

    <input type="file" id="jsonImportInput" class="hidden-file-input" accept=".json">
    <input type="file" id="csvImportInput" class="hidden-file-input" accept=".csv">

    <div class="bg-gray-800 p-4 md:p-6 rounded-2xl shadow-2xl w-full max-w-6xl border border-gray-700">
        
        <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">            
            <h1 class="text-2xl md:text-3xl font-bold text-white tracking-wide">SlotCar Cockpit <span class="text-blue-500 text-sm align-top">V5.1</span></h1>
            <div id="connectionControls" class="flex gap-2 hidden">
                 <button id="resetAlarmButton" class="hidden bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg">Reset</button>
                <button id="connectButton" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg">Verbinden</button>
                <button id="disconnectButton" class="hidden bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">Trennen</button>    
            </div>        
        </div>                
        
        <div id="statusTextWrapper" class="mb-6 hidden">            
             <p id="statusText" class="text-gray-400 text-center text-sm">Nicht verbunden.</p>        
        </div>                                

        <div class="grid grid-cols-3 gap-0 mb-4 bg-gray-900 rounded-lg overflow-hidden border border-gray-700">            
            <button id="main-tab-logbuch" class="main-tab-button active py-3 px-2 md:px-4 font-bold text-sm md:text-lg" onclick="showMainTab('logbuch')">Cockpit</button>
            <button id="main-tab-championship" class="main-tab-button inactive py-3 px-2 md:px-4 font-bold text-sm md:text-lg" onclick="showMainTab('championship')">Meisterschaft</button>
            <button id="main-tab-dyno" class="main-tab-button inactive py-3 px-2 md:px-4 font-bold text-sm md:text-lg" onclick="showMainTab('dyno')">Dyno</button>        
        </div> 
        
        <div id="sub-nav-dyno" class="hidden grid grid-cols-3 gap-2 mb-4 p-1 bg-gray-700 rounded-lg">            
            <button id="tab-live" class="tab-button inactive py-2 px-4 rounded-md font-semibold" onclick="showSubTab('dyno', 'live')">Live</button>      
            <button id="tab-dyno" class="tab-button active py-2 px-4 rounded-md font-semibold" onclick="showSubTab('dyno', 'dyno')">Dyno</button>            
            <button id="tab-settings" class="tab-button inactive py-2 px-4 rounded-md font-semibold" onclick="showSubTab('dyno', 'settings')">Settings</button>        
        </div>        
        
        <div id="sub-nav-logbuch" class="grid grid-cols-4 gap-1 mb-4 p-1 bg-gray-700 rounded-lg overflow-x-auto">            
            <button id="tab-events" class="tab-button active py-2 px-2 rounded-md font-semibold text-xs md:text-sm" onclick="showSubTab('logbuch', 'events')">Events</button>            
            <button id="tab-strecken" class="tab-button inactive py-2 px-2 rounded-md font-semibold text-xs md:text-sm" onclick="showSubTab('logbuch', 'strecken')">Strecken</button>            
            <button id="tab-autos" class="tab-button inactive py-2 px-2 rounded-md font-semibold text-xs md:text-sm" onclick="showSubTab('logbuch', 'autos')">Autos</button>            
            <button id="tab-motoren" class="tab-button inactive py-2 px-2 rounded-md font-semibold text-xs md:text-sm" onclick="showSubTab('logbuch', 'motoren')">Motoren</button>        
        </div>

        <div id="sub-nav-championship" class="hidden grid grid-cols-2 gap-2 mb-4 p-1 bg-gray-700 rounded-lg">
            <button id="tab-standings" class="tab-button active py-2 px-4 rounded-md font-semibold" onclick="showSubTab('championship', 'standings')">Verwaltung & Tabelle</button>
            <button id="tab-manager" class="tab-button inactive py-2 px-4 rounded-md font-semibold" onclick="showSubTab('championship', 'manager')">Renn-Leitung</button>
        </div>

        <div id="main-content-dyno" class="main-content-area inactive">                        
            <h2 class="text-xl font-bold text-center text-gray-500 mb-4">RS Dyno</h2>
            <div id="content-live" class="tab-content inactive">                
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">                    
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">RPM (Motor)</span><p id="rpmValue" class="text-4xl font-black text-white">---</p></div>                     
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">Speed (Rolle)</span><p id="speedValue" class="text-4xl font-black text-white">---</p><span class="text-lg text-gray-300">m/s</span></div>                    
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">Drehmoment</span><p id="torqueValue" class="text-4xl font-black text-white">---</p><span class="text-lg text-gray-300">mNm</span></div>                    
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">Effizienz</span><p id="efficiencyValue" class="text-4xl font-black text-white">---</p><span class="text-lg text-gray-300">%</span></div>              
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">V-In</span><p id="vinValue" class="text-4xl font-black text-white">---</p><span class="text-lg text-gray-300">Volt</span></div>                    
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-yellow-300 font-medium uppercase">Theor. Speed</span><p id="calculatedKmhValue" class="text-4xl font-black text-white">---</p><span class="text-lg text-gray-300">km/h</span></div>                    
                    <div class="bg-gray-700 p-4 rounded-lg text-center col-span-2 md:col-span-3">                        
                        <span class="text-sm text-blue-300 font-medium uppercase">Umgebungs- & Temperatur-Daten</span>                        
                        <div class="mt-2 grid grid-cols-1 md:grid-cols-3 gap-2 text-lg">                            
                            <p class="text-gray-300">Lastmotor (¬∞C): <span id="tempMotorValue" class="font-bold text-white text-2xl">---</span></p>                            
                            <p class="text-gray-300">Geh√§use (¬∞C): <span id="tempAmbientValue" class="font-bold text-white text-2xl">---</span></p>              
                            <p class="text-gray-300">Luftfeuchte (%): <span id="humidityValue" class="font-bold text-white text-2xl">---</span></p>                         
                        </div>  
                    </div>                
                </div>                
                <div class="grid grid-cols-1 gap-4 mt-4"><div class="bg-gray-700 p-4 rounded-lg"><h3 class="text-lg font-semibold text-center mb-2">Live RPM (Motor) (Letzte 60s)</h3><canvas id="liveRpmChart"></canvas></div></div>             
            </div>             
            
            <div id="content-dyno" class="tab-content active">                
                <p id="dynoStatus" class="text-center text-yellow-400 mb-4">Warte auf n√§chsten Dyno-Lauf vom Pr√ºfstand...</p>                
                <div class="flex flex-col md:flex-row gap-4 mb-4 bg-gray-700 p-4 rounded-lg items-start justify-between">                    
                    <div class="flex-1"><label class="block text-sm font-medium text-gray-300 mb-2">Vergleiche mit (Garage):</label><div id="dynoCompareCheckboxes" class="max-h-32 overflow-y-auto"><p class="text-gray-400">Garage ist leer.</p></div></div>                    
                    <div class="flex-1 flex justify-end gap-2">                        
                        <button id="saveDynoButton" class="hidden bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">Lauf speichern</button>                        
                        <button id="clearGarageButton" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">Garage leeren</button>                
                    </div>                
                </div>                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">      
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">Max. Leistung (P_in)</span><p id="dynoMaxPower" class="text-4xl font-black text-white">---</p><span id="dynoMaxPowerRpm" class="text-lg text-gray-300">@ --- RPM</span></div>                    
                    <div class="bg-gray-700 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">Max. Drehmoment (T_out)</span><p id="dynoMaxTorque" class="text-4xl font-black text-white">---</p><span id="dynoMaxTorqueRpm" class="text-lg text-gray-300">@ --- RPM</span></div>                
                </div>                
                <div class="bg-gray-700 p-4 rounded-lg"><canvas id="dynoChart"></canvas></div>            
             </div>            
            
            <div id="content-settings" class="tab-content inactive">                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">                     
                    <div class="bg-gray-700 p-6 rounded-lg md:col-span-2">                        
                        <h3 class="text-xl font-semibold mb-4 text-yellow-300">Getrieberechner</h3>                        
                        <div class="mb-6 bg-gray-800 p-4 rounded-lg text-center"><span class="text-sm text-blue-300 font-medium uppercase">Roll-Out</span><p id="rolloutValue" class="text-3xl font-black text-white">---</p><span class="text-lg text-gray-300">mm / Motorumdrehung</span></div>                         
                        <div class="space-y-4">           
                            <div><label for="settingGearRitzel" class="block text-sm font-medium text-gray-300">Motor-Ritzel (Z√§hne)</label><input type="number" id="settingGearRitzel" value="10" class="mt-1 block w-full bg-gray-800 border-gray-600 text-white rounded-md shadow-sm p-2"></div>                            
                            <div><label for="settingGearKranz" class="block text-sm font-medium text-gray-300">Achse-Kronrad (Z√§hne)</label><input type="number" id="settingGearKranz" value="40" class="mt-1 block w-full bg-gray-800 border-gray-600 text-white rounded-md shadow-sm p-2"></div>                            
                            <div><label for="settingTireDiameter" class="block text-sm font-medium text-gray-300">Reifen-Durchmesser (mm)</label><input type="number" id="settingTireDiameter" value="24" class="mt-1 block w-full bg-gray-800 border-gray-600 text-white rounded-md shadow-sm p-2"></div>                        
                        </div>                                         
                        <h3 class="text-xl font-semibold mt-8 mb-4 text-green-300">Motor-Drehzahl-Rechner (Offline)</h3>                        
                        <div class="space-y-4"><div><label for="manualRollerRpm" class="block text-sm font-medium text-gray-300">Max. Rollen-Drehzahl (U/min)</label><input type="number" id="manualRollerRpm" placeholder="z.B. 8000" class="mt-1 block w-full bg-gray-800 border-gray-600 text-white rounded-md shadow-sm p-2"></div></div>                        
                        <div class="mt-6 bg-gray-800 p-4 rounded-lg text-center">                            
                             <span class="text-sm text-blue-300 font-medium uppercase">Berechnete Motor-Drehzahl</span>                             
                            <p id="calculatedMotorRpm" class="text-3xl font-black text-white">---</p>           
                            <span class="text-lg text-gray-300">U/min</span>                        
                        </div>     
                    </div>                
                </div>                 
                <div class="mt-6 text-center"><button id="saveSettingsButton" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">Einstellungen Speichern</button></div>                                
                
                <div class="mt-6 bg-gray-700 p-6 rounded-lg">                 
                    <h3 class="text-xl font-semibold mb-4 text-green-300">App-Daten (Backup & Export)</h3>                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">                         
                        <button id="jsonExportButton" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">Backup (JSON) Exportieren</button>            
                        <button id="jsonImportButton" class="w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg">Backup (JSON) Importieren</button>                    
                    </div>             
                </div>            
            </div>     
        </div>

        <div id="main-content-logbuch" class="main-content-area active">                        
            <div id="content-events" class="tab-content active">                
                <div class="flex gap-2 mb-4 items-center"> <input type="search" id="eventSearchInput" placeholder="Suche..." class="flex-grow bg-gray-900 text-white rounded-lg p-2 text-sm border border-gray-600">
                    <button id="addEventButton" class="flex-none bg-green-600 hover:bg-green-700 text-white font-black py-2 px-4 rounded-lg text-xl leading-none" title="Neues Event">+</button>                    
                </div>         
                <div class="logbook-table-wrapper">                     
                    <table class="logbook-table">                        
                       <thead>
                            <tr>
                                <th onclick="sortTable('events', 'datum')">Datum &#x21C5;</th>
                                <th onclick="sortTable('events', 'klasse')">Klasse &#x21C5;</th>
                                <th onclick="sortTable('events', 'strecke')">Strecke &#x21C5;</th>
                                <th onclick="sortTable('events', 'platz')">Platz &#x21C5;</th>
                                <th onclick="sortTable('events', 'besteRunde')">Bestzeit &#x21C5;</th>
                                <th onclick="sortTable('events', 'runden')">Runden &#x21C5;</th>
                                <th onclick="sortTable('events', 'fahrzeug')">Fahrzeug &#x21C5;</th>
                                <th onclick="sortTable('events', 'reifen')">Reifen &#x21C5;</th>
                                <th onclick="sortTable('events', 'motor')">Motor &#x21C5;</th>
                                <th class="text-center">Aktionen</th>
                            </tr>
                        </thead>                        
                        <tbody id="eventsTbody"></tbody>         
                    </table>                
                </div>                 
                <div class="mt-4 flex gap-2 justify-end">                    
                    <button onclick="exportToCsv('events')" class="bg-gray-600 hover:bg-gray-700 text-white py-1 px-3 rounded text-xs">CSV Export</button> <button onclick="importFromCsv('events')" class="bg-yellow-600 hover:bg-yellow-700 text-white py-1 px-3 rounded text-xs">CSV Import</button>                
                </div>         
            </div>                        
            
            <div id="content-strecken" class="tab-content inactive">                 
                <div class="flex gap-2 mb-4 items-center"> <input type="search" id="streckeSearchInput" placeholder="Suche..." class="flex-grow bg-gray-900 text-white rounded-lg p-2 text-sm border border-gray-600">
                    <button id="addStreckeButton" class="flex-none bg-green-600 hover:bg-green-700 text-white font-black py-2 px-4 rounded-lg text-xl leading-none" title="Neue Strecke">+</button>                    
                </div>               
                <div class="logbook-table-wrapper">                    
                    <table class="logbook-table">                         
                        <thead><tr><th>Name</th><th>Ort</th><th>L√§nge (m)</th><th>Streckentyp</th><th>Spannung (V)</th><th>Rekord (s)</th><th>Opt. Roll-Out</th><th class="text-center">Aktionen</th></tr></thead>                        
                        <tbody id="streckenTbody"></tbody>                    
                    </table>          
                </div>                
                <div class="mt-4 flex gap-2 justify-end">                     
                    <button onclick="exportToCsv('strecken')" class="bg-gray-600 hover:bg-gray-700 text-white py-1 px-3 rounded text-xs">CSV Export</button>                    
                    <button onclick="importFromCsv('strecken')" class="bg-yellow-600 hover:bg-yellow-700 text-white py-1 px-3 rounded text-xs">CSV Import</button>                
                </div>           
            </div>            
            
            <div id="content-autos" class="tab-content inactive">                 
                <div class="flex gap-2 mb-4 items-center"> <input type="search" id="autoSearchInput" placeholder="Suche..." class="flex-grow bg-gray-900 text-white rounded-lg p-2 text-sm border border-gray-600">
                    <button id="addAutoButton" class="flex-none bg-green-600 hover:bg-green-700 text-white font-black py-2 px-4 rounded-lg text-xl leading-none" title="Neues Auto">+</button>                    
                </div>                 
                <div class="logbook-table-wrapper">                    
                    <table class="logbook-table">                        
                        <thead><tr><th>Klasse</th><th>Chassis</th><th>Karosserie</th><th>Motor</th><th>Zahnrad</th><th>Federn</th><th>Wackel</th><th>Gewichtsver.</th><th>Kugellager</th><th>H√∂he</th><th>Reifengr√∂√üe</th><th class="text-center">Aktionen</th></tr></thead>      
                        <tbody id="autosTbody"></tbody>                    
                    </table>                
                </div>                
                <div class="mt-4 flex gap-2 justify-end">                    
                    <button onclick="exportToCsv('autos')" class="bg-gray-600 hover:bg-gray-700 text-white py-1 px-3 rounded text-xs">CSV Export</button>                     
                    <button onclick="importFromCsv('autos')" class="bg-yellow-600 hover:bg-yellow-700 text-white py-1 px-3 rounded text-xs">CSV Import</button>                
                </div>            
            </div>            
            
            <div id="content-motoren" class="tab-content inactive">                 
                <div class="flex gap-2 mb-4 items-center"> <input type="search" id="motorSearchInput" placeholder="Suche..." class="flex-grow bg-gray-900 text-white rounded-lg p-2 text-sm border border-gray-600">
                    <button id="addMotorButton" class="flex-none bg-green-600 hover:bg-green-700 text-white font-black py-2 px-4 rounded-lg text-xl leading-none" title="Neuer Motor">+</button>                    
                </div>                 
                <div class="logbook-table-wrapper">   
                    <table class="logbook-table">                        
                        <thead>
                             <tr>
                                <th onclick="sortTable('motoren', 'name')">Name &#x21C5;</th>
                                <th onclick="sortTable('motoren', 'klasse')">Klasse &#x21C5;</th>
                                <th onclick="sortTable('motoren', 'hersteller')">Hersteller &#x21C5;</th>
                                <th onclick="sortTable('motoren', 'rpm')">RPM &#x21C5;</th>
                                <th onclick="sortTable('motoren', 'maxRpm')">Max RPM &#x21C5;</th>
                                <th onclick="sortTable('motoren', 'rennen')">Rennen &#x21C5;</th>
                                <th onclick="sortTable('motoren', 'status')">Status &#x21C5;</th>
                                <th class="text-center">Aktionen</th>
                            </tr>
                        </thead>                        
                        <tbody id="motorenTbody"></tbody>      
                    </table>                 
                </div>                
                <div class="mt-4 flex gap-2 justify-end">                    
                    <button onclick="exportToCsv('motoren')" class="bg-gray-600 hover:bg-gray-700 text-white py-1 px-3 rounded text-xs">CSV Export</button>                    
                    <button onclick="importFromCsv('motoren')" class="bg-yellow-600 hover:bg-yellow-700 text-white py-1 px-3 rounded text-xs">CSV Import</button>                 
                </div>            
            </div>        
        </div>

        <div id="main-content-championship" class="main-content-area inactive">
            <h2 class="text-xl font-bold text-center text-yellow-500 mb-4">Renn-Management & Meisterschaft</h2>
            
            <div id="content-standings" class="tab-content active">
                <div id="champOverview">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-semibold text-yellow-400">Meine Meisterschaften</h3>
                        <button onclick="openCreateChampModal()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg text-sm">+ Neue Serie</button>
                    </div>

                    <h4 class="text-sm text-gray-400 uppercase font-bold mb-2 border-b border-gray-700 pb-1">Aktuell</h4>
                    <div id="champListActive" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8"></div>

                    <h4 class="text-sm text-gray-500 uppercase font-bold mb-2 border-b border-gray-800 pb-1 mt-8">Archiv</h4>
                    <div id="champListArchive" class="grid grid-cols-1 md:grid-cols-2 gap-4 opacity-60"></div>
                </div>

                <div id="champDetail" class="hidden">
                    <div class="flex flex-col gap-4 mb-4">
                        <button onclick="closeChampDetail()" class="self-start bg-gray-600 hover:bg-gray-500 text-white py-1 px-3 rounded text-sm">‚Üê Zur√ºck zur √úbersicht</button>
                        
                        <div class="flex flex-col md:flex-row justify-between items-end gap-4">
                            <div>
                                <h2 id="champTitle" class="text-2xl font-bold text-white">Serie Titel</h2>
                                <p id="champPointsInfo" class="text-gray-400 text-sm">Punkteschema: ...</p>
                            </div>
                            <button onclick="openAddRaceModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-lg w-full md:w-auto">+ Rennergebnis erfassen</button>
                        </div>
                    </div>

                    <div class="logbook-table-wrapper bg-gray-900 rounded-lg p-1 overflow-x-auto shadow-2xl">
                        <table class="logbook-table w-full text-left border-collapse" id="champTable"></table>
                    </div>
                    
                    <div class="mt-6 flex flex-col md:flex-row justify-between items-center bg-gray-800 p-4 rounded border border-gray-600 gap-4">
                        <div>
                            <h4 class="font-bold text-white">Verwaltung & Export</h4>
                            <p class="text-xs text-gray-400">Tabelle teilen oder Status √§ndern</p>
                        </div>
                        <div class="flex gap-3 w-full md:w-auto">
                            <button onclick="toggleChampArchive(activeChampId)" id="btnArchive" class="flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded text-sm border border-gray-500">
                                üìÇ Archivieren
                            </button>
                            <button onclick="openExportModal()" class="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded text-sm shadow-lg flex items-center justify-center gap-2">
                                <span>üì§</span> Exportieren
                            </button>
                        </div>
                    </div>

                    <div id="champRacesList" class="mt-8">
                         <h4 class="text-lg font-semibold text-gray-400 mb-2">Erfasste Rennen (Verlauf)</h4>
                         <div id="champRacesHistory" class="space-y-2"></div>
                    </div>
                </div>
            </div>

            <div id="content-manager" class="tab-content inactive">
    
                <div id="rmGeneralSetup" class="bg-gray-800 p-6 rounded-lg border border-gray-700 max-w-3xl mx-auto mt-8">
                    <h3 class="text-2xl font-bold text-white mb-2 text-center">üèÅ Rennabend Konfigurator</h3>
                    <p class="text-gray-400 text-center mb-8 text-sm">Basisdaten f√ºr die Zeitplan-Berechnung.</p>
            
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-blue-300 text-sm font-bold mb-2">Anzahl Fahrer</label>
                                <input type="number" id="setupDrivers" value="6" min="2" class="w-full bg-gray-900 text-white text-lg p-3 rounded border border-gray-600 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-blue-300 text-sm font-bold mb-2">Anzahl Spuren</label>
                                <input type="number" id="setupLanes" value="4" min="2" max="8" class="w-full bg-gray-900 text-white text-lg p-3 rounded border border-gray-600 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-green-400 text-sm font-bold mb-2">√ò Rundenzeit (Sek)</label>
                                <input type="number" id="setupAvgLap" value="10" step="0.1" min="1" class="w-full bg-gray-900 text-white text-lg p-3 rounded border border-gray-600 focus:border-green-500" title="Gesch√§tzte Zeit f√ºr eine Runde">
                            </div>
                        </div>
            
                        <div>
                            <label class="block text-yellow-400 text-sm font-bold mb-2">Verf√ºgbare Zeit (Gesamt)</label>
                            <div class="flex items-center gap-4">
                                <input type="range" id="setupTimeRange" min="60" max="360" step="15" value="180" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('setupTimeDisplay').textContent = this.value + ' min'">
                                <span id="setupTimeDisplay" class="text-2xl font-bold text-white w-24 text-right">180 min</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">* Die Berechnung reserviert automatisch Zeit f√ºr Training (15m) und Fahrerwechsel (2m pro Lauf).</p>
                        </div>
            
                        <button onclick="raceMgr.processGeneralSetup()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-lg shadow-lg text-lg transition transform hover:scale-[1.02]">
                            Rennmodi berechnen üöÄ
                        </button>
                    </div>
                </div>
            
                <div id="rmSelectMode" class="hidden space-y-6">
                    <div class="flex justify-between items-center">
                        <h3 class="text-xl font-bold text-white">W√§hle deinen Renn-Modus</h3>
                        <button onclick="raceMgr.showView('rmGeneralSetup')" class="text-sm text-gray-400 hover:text-white">‚öôÔ∏è Setup √§ndern</button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <button onclick="raceMgr.selectMode('classic')" class="bg-gray-800 hover:bg-gray-700 border border-gray-600 hover:border-blue-500 p-6 rounded-xl text-left transition group relative overflow-hidden">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-2xl">üèéÔ∏è</span>
                                <span class="bg-blue-900 text-blue-200 text-xs px-2 py-1 rounded uppercase">Einsteiger</span>
                            </div>
                            <h4 class="text-lg font-bold text-white group-hover:text-blue-400">Classic Cup</h4>
                            <p class="text-sm text-gray-400 mt-1 mb-2">Jeder gegen Jeden. Rotation durch alle Spuren.</p>
                            <div id="sugg_classic" class="text-xs font-mono text-green-400 bg-gray-900/50 p-2 rounded border border-green-900/30">
                                Berechne...
                            </div>
                        </button>
            
                        <button onclick="raceMgr.selectMode('profi')" class="bg-gray-800 hover:bg-gray-700 border border-gray-600 hover:border-yellow-500 p-6 rounded-xl text-left transition group">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-2xl">üèÜ</span>
                                <span class="bg-yellow-900 text-yellow-200 text-xs px-2 py-1 rounded uppercase">Profi GT124</span>
                            </div>
                            <h4 class="text-lg font-bold text-white group-hover:text-yellow-400">Quali - Sprint - Main</h4>
                            <p class="text-sm text-gray-400 mt-1 mb-2">Qualifikation, 6 Sprintrennen und Finale.</p>
                            <div id="sugg_profi" class="text-xs font-mono text-yellow-400 bg-gray-900/50 p-2 rounded border border-yellow-900/30">
                                Berechne...
                            </div>
                        </button>
            
                        <button onclick="raceMgr.selectMode('ko')" class="bg-gray-800 hover:bg-gray-700 border border-gray-600 hover:border-red-500 p-6 rounded-xl text-left transition group">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-2xl">ü•ä</span>
                                <span class="bg-red-900 text-red-200 text-xs px-2 py-1 rounded uppercase">Turnier</span>
                            </div>
                            <h4 class="text-lg font-bold text-white group-hover:text-red-400">K.O. System</h4>
                            <p class="text-sm text-gray-400 mt-1 mb-2">Quali + Duelle (1vs1) bis zum Finale.</p>
                            <div id="sugg_ko" class="text-xs font-mono text-red-400 bg-gray-900/50 p-2 rounded border border-red-900/30">
                                Berechne...
                            </div>
                        </button>
            
                        <button onclick="raceMgr.selectMode('endurance')" class="bg-gray-800 hover:bg-gray-700 border border-gray-600 hover:border-green-500 p-6 rounded-xl text-left transition group">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-2xl">‚è±Ô∏è</span>
                                <span class="bg-green-900 text-green-200 text-xs px-2 py-1 rounded uppercase">Team</span>
                            </div>
                            <h4 class="text-lg font-bold text-white group-hover:text-green-400">Endurance Team</h4>
                            <p class="text-sm text-gray-400 mt-1 mb-2">Langstrecke auf Zeit mit Fahrerwechseln.</p>
                            <div id="sugg_endurance" class="text-xs font-mono text-green-400 bg-gray-900/50 p-2 rounded border border-green-900/30">
                                Berechne...
                            </div>
                        </button>
                    </div>
                </div>
            
                <div id="rmSetup" class="hidden bg-gray-800 p-6 rounded-lg border border-gray-700">
                    <h3 class="text-xl font-bold text-white mb-1">Renn-Setup: <span id="rmSetupTitle" class="text-blue-400"></span></h3>
                    <p id="rmSetupSummary" class="text-sm text-gray-400 mb-4 italic border-b border-gray-600 pb-2"></p>
                    
                    <div class="mb-6">
                        <label class="block text-gray-400 text-sm mb-2">Fahrer Nennung (<span id="driverCountLabel">0</span>)</label>
                        <div id="rmDriverSelection" class="grid grid-cols-2 md:grid-cols-4 gap-2 max-h-60 overflow-y-auto bg-gray-900 p-3 rounded border border-gray-600">
                            </div>
                        <div class="mt-2 flex gap-2">
                            <input type="text" id="rmNewDriverName" placeholder="Gastfahrer Name..." class="bg-gray-700 text-white text-sm p-2 rounded border border-gray-600">
                            <button onclick="raceMgr.addGuestDriver()" class="bg-gray-600 hover:bg-gray-500 text-white px-3 py-1 rounded text-sm">+ Gast</button>
                        </div>
                    </div>
            
                    <div class="flex justify-between">
                        <button onclick="raceMgr.showView('rmSelectMode')" class="text-gray-400 hover:text-white">Zur√ºck</button>
                        <button onclick="raceMgr.startSession()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-8 rounded shadow-lg animate-pulse">Rennabend Starten üèÅ</button>
                    </div>
                </div>
            
                <div id="rmActive" class="hidden">
                    <div class="bg-gray-800 p-4 rounded-t-lg border-b border-gray-700 flex justify-between items-center">
                        <div>
                            <h2 id="rmPhaseTitle" class="text-2xl font-bold text-yellow-400">Qualifikation</h2>
                            <p id="rmPhaseSubtitle" class="text-sm text-gray-400">Runde 1 von 6</p>
                        </div>
                        <div class="text-right">
                            <button onclick="raceMgr.abortSession()" class="text-red-500 text-xs hover:text-red-400">Abbrechen</button>
                        </div>
                    </div>
                    <div class="bg-gray-900 p-4 md:p-8 border-x border-gray-700 min-h-[300px] flex flex-col items-center justify-center">
                        <div id="rmDynamicContent" class="w-full max-w-4xl"></div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-b-lg border-t border-gray-700 flex justify-between items-center">
                        <div id="rmStatusMsg" class="text-blue-300 text-sm italic">Warte auf Eingabe...</div>
                        <button id="rmNextBtn" onclick="raceMgr.nextStep()" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded shadow-lg flex items-center gap-2">
                            N√§chste Phase ‚û°Ô∏è
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <p class="text-center text-gray-500 text-xs mt-6">Developed by RS | V5.1 Modular</p>    
    </div>

    <div id="dynoSaveModal" class="modal"><div class="modal-content bg-gray-700 rounded-lg"><form id="dynoSaveForm"><div><label for="dynoRunMotorSelect" class="block text-sm font-medium text-gray-300">1. Motor ausw√§hlen</label><select id="dynoRunMotorSelect" class="mt-1 block w-full bg-gray-800 rounded-md p-2" required></select></div><div class="mt-4"><label for="dynoRunName" class="block text-sm font-medium text-gray-300">2. Name des Laufs</label><input type="text" id="dynoRunName" placeholder="z.B. Test nach Reinigung" class="mt-1 block w-full bg-gray-800 border-gray-600 text-white rounded-md shadow-sm p-2 mb-4" required></div><div class="flex justify-end gap-2 mt-4"><button type="button" id="cancelDynoSaveButton" class="bg-gray-500 text-white py-2 px-4 rounded-lg">Abbrechen</button><button type="submit" id="confirmDynoSaveButton" class="bg-green-600 text-white py-2 px-4 rounded-lg">Speichern</button></div></form></div></div>
    <div id="autosModal" class="modal"><div class="modal-content modal-content-large bg-gray-700 rounded-lg"><h2 id="autosModalTitle" class="text-xl font-bold mb-4">Auto bearbeiten</h2><form id="autosForm"><input type="hidden" id="autoIdInput"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Klasse</label><input type="text" id="autoKlasse" class="mt-1 block w-full bg-gray-800 rounded-md p-2" required></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Chassis</label><input type="text" id="autoChassis" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Karosserie</label><input type="text" id="autoKarosserie" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Federn</label><input type="text" id="autoFedern" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Wackel</label><input type="text" id="autoWackel" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Gewichtsver.</label><input type="text" id="autoGewichtsver" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Kugellager</label><input type="text" id="autoKugellager" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">H√∂he (mm)</label><input type="number" step="0.1" id="autoHoehe" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">min. Reifen</label><input type="number" step="0.1" id="autoReifen" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Motor</label><input type="text" id="autoMotor" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-2"><label class="block text-sm font-medium text-gray-300">Zahnrad</label><input type="text" id="autoZahnrad" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-3"><label class="block text-sm font-medium text-gray-300">Kommentare</label><textarea id="autoKommentare" rows="3" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></textarea></div></div><div class="flex justify-end gap-2 mt-6"><button type="button" id="cancelAutoButton" class="bg-gray-500 text-white py-2 px-4 rounded-lg">Abbrechen</button><button type="submit" id="saveAutoButton" class="bg-green-600 text-white py-2 px-4 rounded-lg">Speichern</button></div></form></div></div>
    <div id="motorenModal" class="modal"><div class="modal-content modal-content-large bg-gray-700 rounded-lg"><h2 id="motorenModalTitle" class="text-xl font-bold mb-4">Motor bearbeiten</h2><form id="motorenForm"><input type="hidden" id="motorIdInput"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Name</label><input type="text" id="motorName" class="mt-1 block w-full bg-gray-800 rounded-md p-2" required></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Klasse</label><input type="text" id="motorKlasse" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Hersteller</label><input type="text" id="motorHersteller" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Status</label><select id="motorStatus" class="mt-1 block w-full bg-gray-800 rounded-md p-2"><option>Neu</option><option>Eingelaufen</option><option>Wartung</option><option>Defekt</option></select></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">RPM</label><input type="number" id="motorRpm" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Max. RPM</label><input type="number" id="motorMaxRpm" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Rennen</label><input type="text" id="motorRennen" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-2"><label class="block text-sm font-medium text-gray-300">Notizen</label><textarea id="motorNotizen" rows="4" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></textarea></div></div><div class="flex justify-end gap-2 mt-6"><button type="button" id="cancelMotorButton" class="bg-gray-500 text-white py-2 px-4 rounded-lg">Abbrechen</button><button type="submit" class="bg-green-600 text-white py-2 px-4 rounded-lg">Speichern</button></div></form></div></div>
    <div id="streckenModal" class="modal"><div class="modal-content modal-content-large bg-gray-700 rounded-lg"><h2 id="streckenModalTitle" class="text-xl font-bold mb-4">Strecke bearbeiten</h2><form id="streckenForm"><input type="hidden" id="streckeIdInput"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Name</label><input type="text" id="streckeName" class="mt-1 block w-full bg-gray-800 rounded-md p-2" required></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Ort</label><input type="text" id="streckeOrt" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">L√§nge (m)</label><input type="text" id="streckeLaenge" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Streckentyp</label><input type="text" id="streckeTyp" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Spannung (V)</label><input type="text" id="streckeSpannung" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-1"><label class="block text-sm font-medium text-gray-300">Rekord (s)</label><input type="text" id="streckeRekord" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-2"><label class="block text-sm font-medium text-gray-300">Opt. Roll-Out</label><input type="text" id="streckeRollout" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div class="md:col-span-2"><label class="block text-sm font-medium text-gray-300">Notizen</label><textarea id="streckeNotizen" rows="4" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></textarea></div></div><div class="flex justify-end gap-2 mt-6"><button type="button" id="cancelStreckeButton" class="bg-gray-500 text-white py-2 px-4 rounded-lg">Abbrechen</button><button type="submit" class="bg-green-600 text-white py-2 px-4 rounded-lg">Speichern</button></div></form></div></div>
    <div id="eventsModal" class="modal"><div class="modal-content modal-content-large bg-gray-700 rounded-lg"><h2 id="eventsModalTitle" class="text-xl font-bold mb-4">Event bearbeiten</h2><form id="eventsForm"><input type="hidden" id="eventIdInput"><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><div><label class="block text-sm font-medium text-gray-300">Datum</label><input type="date" id="eventDatum" class="mt-1 block w-full bg-gray-800 rounded-md p-2" required></div><div><label class="block text-sm font-medium text-gray-300">Klasse</label><input type="text" id="eventKlasse" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div></div><h3 class="text-lg font-semibold text-blue-300 mb-2">Setup-Informationen</h3><div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"><div><label class="block text-sm font-medium text-gray-300">Strecke</label><select id="eventStrecke" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></select><input type="text" id="eventStreckeManuell" class="mt-2 hidden w-full bg-gray-900 rounded-md p-2" placeholder="Manuelle Eingabe..."></div><div><label class="block text-sm font-medium text-gray-300">Fahrzeug</label><select id="eventFahrzeug" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></select><input type="text" id="eventFahrzeugManuell" class="mt-2 hidden w-full bg-gray-900 rounded-md p-2" placeholder="Manuelle Eingabe..."></div><div><label class="block text-sm font-medium text-gray-300">Motor</label><select id="eventMotor" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></select><input type="text" id="eventMotorManuell" class="mt-2 hidden w-full bg-gray-900 rounded-md p-2" placeholder="Manuelle Eingabe..."></div><div><label class="block text-sm font-medium text-gray-300">Getriebe</label><input type="text" id="eventGetriebe" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Reifen</label><input type="text" id="eventReifen" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Federn</label><input type="text" id="eventFedern" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Wackel</label><input type="text" id="eventWackel" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Gewicht</label><input type="text" id="eventGewicht" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div></div><h3 class="text-lg font-semibold text-blue-300 mb-2">Performance</h3><div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"><div><label class="block text-sm font-medium text-gray-300">Quali</label><input type="text" id="eventQuali" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Bestzeit</label><input type="text" id="eventBesteRunde" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Platz</label><input type="text" id="eventPlatz" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Rennzeit</label><input type="text" id="eventRennzeit" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div><div><label class="block text-sm font-medium text-gray-300">Runden</label><input type="text" id="eventRunden" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></div></div><h3 class="text-lg font-semibold text-blue-300 mb-2">Kommentare</h3><div><textarea id="eventKommentare" rows="4" class="mt-1 block w-full bg-gray-800 rounded-md p-2"></textarea></div><div class="flex justify-end gap-2 mt-6"><button type="button" id="cancelEventButton" class="bg-gray-500 text-white py-2 px-4 rounded-lg">Abbrechen</button><button type="submit" id="saveEventButton" class="bg-green-600 text-white py-2 px-4 rounded-lg">Speichern</button></div></form></div></div>

    <div id="createChampModal" class="modal"><div class="modal-content bg-gray-800 rounded-lg border border-gray-600 max-w-lg w-full"><div class="flex justify-between items-start mb-4"><h2 class="text-xl font-bold text-white">Neue Meisterschaftsserie</h2><button onclick="document.getElementById('createChampModal').style.display='none'" class="text-gray-400 hover:text-white">‚úï</button></div><form id="createChampForm"><input type="hidden" id="editChampId"><div class="mb-4"><label class="block text-gray-300 text-sm mb-1 font-semibold">Name der Serie</label><input type="text" id="newChampName" placeholder="z.B. Clubmeisterschaft 2025" class="w-full bg-gray-700 text-white rounded p-2 border border-gray-600" required></div><div class="mb-4 p-3 bg-gray-900 rounded border border-gray-700"><label class="block text-yellow-400 text-sm mb-1 font-bold">Punkteschema (Platz 1 absteigend)</label><input type="text" id="newChampPoints" value="20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1" class="w-full bg-gray-700 text-white rounded p-2 text-sm"><div class="flex gap-2 mt-2"><button type="button" onclick="setPreset('dtsw')" class="text-xs bg-gray-700 px-2 py-1 rounded hover:bg-gray-600">DTSW (20,19...)</button><button type="button" onclick="setPreset('f1')" class="text-xs bg-gray-700 px-2 py-1 rounded hover:bg-gray-600">F1 (25,18...)</button></div></div><div class="mb-4 p-3 bg-gray-900 rounded border border-gray-700 grid grid-cols-2 gap-4"><div><label class="block text-blue-300 text-sm mb-1 font-bold">Pole Position (Pkt)</label><input type="number" id="newChampBonusPole" value="1" min="0" class="w-full bg-gray-700 text-white rounded p-2 text-sm"></div><div><label class="block text-red-300 text-sm mb-1 font-bold">Schnellste Runde (Pkt)</label><input type="number" id="newChampBonusFastest" value="1" min="0" class="w-full bg-gray-700 text-white rounded p-2 text-sm"></div></div><div class="mb-6 p-4 bg-gray-900 rounded border border-gray-700 flex items-center justify-between"><div><label class="block text-green-400 text-sm font-bold">Streichresultate anwenden?</label><p class="text-xs text-gray-400 mt-1">Automatisch (ab 3 Rennen: 1, ab 5: 2...)</p></div><div class="flex items-center"><label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" id="useDropRaces" class="sr-only peer" checked><div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div><span class="ml-3 text-sm font-medium text-gray-300">Ja</span></label></div></div><div class="flex justify-end gap-2"><button type="button" onclick="document.getElementById('createChampModal').style.display='none'" class="bg-gray-600 text-white py-2 px-4 rounded">Abbrechen</button><button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded shadow-lg">Erstellen</button></div></form></div></div>
    <div id="addRaceModal" class="modal"><div class="modal-content modal-content-large bg-gray-800 rounded-lg border border-gray-600 max-h-[95vh] overflow-y-auto"><div class="flex justify-between items-start mb-4"><h2 class="text-xl font-bold text-white">Rennergebnis eintragen</h2><button onclick="document.getElementById('addRaceModal').style.display='none'" class="text-gray-400 hover:text-white">‚úï</button></div><form id="addRaceForm"><input type="hidden" id="editRaceId"><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 bg-gray-900 p-4 rounded"><div><label class="block text-gray-300 text-sm mb-1">Datum</label><input type="date" id="raceDateInput" class="w-full bg-gray-700 text-white rounded p-2 border border-gray-600" required></div><div><label class="block text-gray-300 text-sm mb-1">Strecke / Ort</label><input type="text" id="raceTrackInput" class="w-full bg-gray-700 text-white rounded p-2 border border-gray-600"></div><div><label class="block text-yellow-400 text-sm mb-1 font-bold">Pole Position</label><input type="text" id="poleInput" list="driverList" class="w-full bg-gray-700 text-white rounded p-2 border border-yellow-600"></div><div><label class="block text-red-400 text-sm mb-1 font-bold">Schnellste Runde</label><input type="text" id="fastestInput" list="driverList" class="w-full bg-gray-700 text-white rounded p-2 border border-red-600"></div></div><h3 class="text-lg font-semibold text-blue-300 mb-2">Platzierungen</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 bg-gray-900 p-4 rounded mb-4" id="placementInputsContainer"></div><datalist id="driverList"></datalist><div class="flex justify-end gap-3 mt-4"><button type="button" onclick="document.getElementById('addRaceModal').style.display='none'" class="bg-gray-600 hover:bg-gray-500 text-white py-2 px-4 rounded">Abbrechen</button><button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded shadow-lg">Ergebnis Speichern</button></div></form></div></div>
    <div id="exportModal" class="modal"><div class="modal-content bg-gray-800 rounded-lg border border-gray-600 max-w-2xl w-full"><div class="flex justify-between items-start mb-6"><div><h2 class="text-xl font-bold text-white">Tabelle exportieren</h2><p class="text-sm text-gray-400">W√§hle das Format f√ºr <span id="exportChampName" class="text-yellow-400"></span></p></div><button onclick="document.getElementById('exportModal').style.display='none'" class="text-gray-400 hover:text-white text-xl">‚úï</button></div><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-gray-900 p-4 rounded border border-gray-700"><h3 class="text-blue-400 font-bold mb-3 flex items-center gap-2">üìÑ Als Webseite (HTML)</h3><p class="text-xs text-gray-500 mb-4">Perfekt f√ºr den Upload auf Vereinsseiten.</p><div class="space-y-3"><button onclick="downloadChampHtml()" class="w-full bg-gray-800 hover:bg-gray-700 text-white py-2 px-3 rounded border border-gray-600 text-sm text-left flex items-center gap-2"><span>üíæ</span> Datei herunterladen (.html)</button><button onclick="copyChampHtmlToClipboard()" class="w-full bg-gray-800 hover:bg-gray-700 text-white py-2 px-3 rounded border border-gray-600 text-sm text-left flex items-center gap-2"><span>üìã</span> Quellcode kopieren</button></div></div><div class="bg-gray-900 p-4 rounded border border-gray-700"><h3 class="text-green-400 font-bold mb-3 flex items-center gap-2">üìä Google Sheets</h3><p class="text-xs text-gray-500 mb-2">Sendet Daten an deine Google Tabelle.</p><div class="mb-3"><label class="text-[10px] text-gray-400 uppercase font-bold">Google Apps Script URL</label><input type="url" id="modalSheetUrl" placeholder="https://script.google.com/..." class="w-full bg-gray-800 text-white text-xs p-2 rounded border border-gray-600 mt-1 focus:border-green-500 outline-none"></div><button onclick="sendChampToSheetFromModal()" class="w-full bg-green-700 hover:bg-green-600 text-white font-bold py-2 rounded text-sm shadow-lg">An Google Sheet senden</button></div></div></div></div>
    <iframe id="hiddenSheetFrame" name="hiddenSheetFrame" style="display:none;"></iframe>

    <script src="js/database.js"></script>
    <script src="js/logbook.js"></script>
    <script src="js/dyno.js"></script>
    <script src="js/championship.js"></script>
    <script src="js/app.js"></script>
</body>
</html>